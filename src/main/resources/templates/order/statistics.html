<!DOCTYPE html>
<html lang="en"
      layout:decorate="~{misc/layout.html}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Title</title>
</head>
<body>
<div layout:fragment="main-content">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#pie_chart" type="button" role="tab" aria-controls="pie_chart" aria-selected="true" th:text="#{order.action.statistics.pieChart}">Pie</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#bar_chart" type="button" role="tab" aria-controls="bar_chart" aria-selected="false" th:text="#{order.action.statistics.barChart}">Bar</button>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div id="pie_chart" class="tab-pane fade show active" role="tabpanel" aria-labelledby="home-tab"></div>
        <div id="bar_chart" class="tab-pane fade" role="tabpanel" aria-labelledby="profile-tab"></div>
        <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab"></div>
    </div>
    <div ></div>
</div>
<th:block layout:fragment="page-scripts">
    <script src="https://www.gstatic.com/charts/loader.js" type="text/javascript"></script>
    <script th:inline="javascript" type="text/javascript">

        google.charts.load('current', {'packages': ['corechart']});

        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Employee');
        data.addColumn('number', 'Orders');
        data.addRows([[${orderSummaries.size}]]);

        let summaries = [[${orderSummaries}]];

            for (let i = 0; i < summaries.length; i++) {
                data.setCell(i, 0, summaries[i].employeeName);
                data.setCell(i, 1, summaries[i].nOrders);
            }

        // data.addRows([[${orderSummaries}]]);

        // Set chart options
        var options = {
        'title': 'Orders by employee',
        'width': 800,
        'height': 600,
    };

        // Instantiate and draw our chart, passing in some options.
        var barChart = new google.visualization.BarChart(document.getElementById('bar_chart'));
            barChart.draw(data, options);
        var pieChart = new google.visualization.PieChart(document.getElementById('pie_chart'));
            pieChart.draw(data, options);
    }
    </script>
</th:block>
</body>
</html>